CC:=clang++
CPPFLAGS:= -g -Wall -std=c++11 -O3 -fsanitize=address
LDFLAGS:= -g -fsanitize=address
OBJS:=Definition.o main.o
TARGET:=test
LIBTARGET:=libtest.dylib

all:$(TARGET) $(LIBTARGET)

$(TARGET):$(OBJS)
	$(CC) $^ $(LDFLAGS) -o $@

$(LIBTARGET):$(OBJS)
	$(CC) -dynamiclib $^ $(LDFLAGS) -o $@

%.o:%.cpp
	$(CC) $(CPPFLAGS) -c $< -o $@

clean:
	rm $(LIBTARGET) $(TARGET) $(OBJS)
